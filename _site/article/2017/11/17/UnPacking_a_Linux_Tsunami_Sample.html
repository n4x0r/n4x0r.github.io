<!DOCTYPE html>
<html lang="es">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<meta name="description" content="In this writeup we’re going to unpack a Tsunami malware sample packed with a modified version of UPX. Hashes of this specific sample are the following:">

	<title>Manually Unpacking Modified UPX Packed Samples</title>
	
	<!-- Bootstrap -->
	<link rel="stylesheet" href="/blog/css/bootstrap.min.css" >
	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	
	<link rel="stylesheet" href="/blog/css/main.css">
	<link rel="canonical" href="http://localhost:4000/blog/article/2017/11/17/UnPacking_a_Linux_Tsunami_Sample.html">
	<link rel="alternate" type="application/rss+xml" title="Bona Fides" href="http://localhost:4000/blog/feed.xml">
</head>
	<body>


	<div id="particles-js"></div>
	<div id="top">
			<div class="container">
				
<style>
.ascii-art {
    font-family: courier;
    white-space: pre;
    color: #f7006f;
     font-size: 0%;
}
.hex {
    font-family: courier;
    white-space: pre;
    color: #f7006f;
     font-size: 120%;
}
.name {
    font-family: courier;
    white-space: pre;
    color: #00f7ef;
     font-size: 120%;
}
img {
  width: auto ;
  max-width: 100% ;
  height: auto ;

}
#t {
  font-family: courier;
  width: auto;
  height: auto;
  font-size: 500%;
  font-weight: normal;
  color: #ffffff;
}

#h {
  font-family: courier;
  width: auto;
  height: auto;
  font-size: 100%;
  font-weight: cursive;
  text-align: center;

}
</style>
<script  src="/blog/js/jquery.min.js"></script>

<header class="container-fluid amnesia_site-header">
  <br />
  <br />
  <br />
  <div id="t">  Bona Fides </div>
  <div id="h">A blog by @ulexec</div>
  <br />
  <br />
  <br />
  <script src="/blog/js/crypt.js"></script>

</header>


				<nav class="container-fluid amnesia_site-navbar">
	<ul class="nav nav-tabs">
		
		
		
		
		<li role="presentation" class="">
			<a href="/blog/">Home</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/malware/">Malware</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/writeups/">CTF</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/cti/">CTI</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/misc/">Misc</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/videos/">Talks</a>
		</li>
		
		
		
		<li role="presentation" class="">
			<a href="/blog/projects/">Projects</a>
		</li>
		
		
	</ul>
</nav>

				<div class="row">
    <div class="col-sm-8">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

            <header class="post-header">
                <h1 class="post-title" itemprop="name headline">Manually Unpacking Modified UPX Packed Samples</h1>
                <p class="post-meta">
                    <time datetime="2017-11-17T06:30:00-08:00" itemprop="datePublished">Nov 17,
                        2017
                    </time>
                     • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span
                        itemprop="name">n4x0r</span></span>
                </p>
            </header>

            <div class="post-content" itemprop="articleBody">
                <p>In this writeup we’re going to unpack a Tsunami malware sample packed with a modified version of <code class="highlighter-rouge">UPX</code>. Hashes of this specific sample are the following:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">SHA256:</span> <span class="n">f22ffc07e0cc907f00fd6a4ecee09fe8411225badb2289c1bffa867a2a3bd863</span>
  <span class="n">SHA1</span><span class="o">:</span> <span class="mi">76584</span><span class="n">c9a22835353186e753903ee0a853663bd83</span>
   <span class="n">MD5</span><span class="o">:</span> <span class="mi">171</span><span class="n">edd284f6a19c6ed3fe010b79c94af</span>
</code></pre></div></div>

<p>In VirusTotal the malware is identified as a Tsunami Variant for the most part:</p>

<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/1.png" /></div>
<p><br />
If we do some static recon about the file, we can see the following:
<br /></p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">readelf</span> <span class="o">-</span><span class="n">lh</span> <span class="n">f22ffc07e0cc907f00fd6a4ecee09fe8411225badb2289c1bffa867a2a3bd863</span>
<span class="n">ELF</span> <span class="n">Header</span><span class="o">:</span>
  <span class="n">Magic</span><span class="o">:</span>   <span class="mi">7</span><span class="n">f</span> <span class="mi">45</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">46</span> <span class="mo">01</span> <span class="mo">01</span> <span class="mo">01</span> <span class="mo">03</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> 
  <span class="n">Class</span><span class="o">:</span>                             <span class="n">ELF32</span>
  <span class="n">Data</span><span class="o">:</span>                              <span class="mi">2</span><span class="err">'</span><span class="n">s</span> <span class="n">complement</span><span class="p">,</span> <span class="n">little</span> <span class="n">endian</span>
  <span class="n">Version</span><span class="o">:</span>                           <span class="mi">1</span> <span class="p">(</span><span class="n">current</span><span class="p">)</span>
  <span class="n">OS</span><span class="o">/</span><span class="n">ABI</span><span class="o">:</span>                            <span class="n">UNIX</span> <span class="o">-</span> <span class="n">GNU</span>
  <span class="n">ABI</span> <span class="n">Version</span><span class="o">:</span>                       <span class="mi">0</span>
  <span class="n">Type</span><span class="o">:</span>                              <span class="n">EXEC</span> <span class="p">(</span><span class="n">Executable</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Machine</span><span class="o">:</span>                           <span class="n">Intel</span> <span class="mi">80386</span>
  <span class="n">Version</span><span class="o">:</span>                           <span class="mh">0x1</span>
  <span class="n">Entry</span> <span class="n">point</span> <span class="n">address</span><span class="o">:</span>               <span class="mh">0xc8da20</span>
  <span class="n">Start</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>          <span class="mi">52</span> <span class="p">(</span><span class="n">bytes</span> <span class="n">into</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Start</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>          <span class="mi">0</span> <span class="p">(</span><span class="n">bytes</span> <span class="n">into</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Flags</span><span class="o">:</span>                             <span class="mh">0x0</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">this</span> <span class="n">header</span><span class="o">:</span>               <span class="mi">52</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>           <span class="mi">32</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Number</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>         <span class="mi">2</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>           <span class="mi">40</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Number</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>         <span class="mi">0</span>
  <span class="n">Section</span> <span class="n">header</span> <span class="n">string</span> <span class="n">table</span> <span class="n">index</span><span class="o">:</span> <span class="mi">0</span>

<span class="n">Program</span> <span class="n">Headers</span><span class="o">:</span>
  <span class="n">Type</span>           <span class="n">Offset</span>   <span class="n">VirtAddr</span>   <span class="n">PhysAddr</span>   <span class="n">FileSiz</span> <span class="n">MemSiz</span>  <span class="n">Flg</span> <span class="n">Align</span>
  <span class="n">LOAD</span>           <span class="mh">0x000000</span> <span class="mh">0x00c01000</span> <span class="mh">0x00c01000</span> <span class="mh">0x8d1c2</span> <span class="mh">0x8d1c2</span> <span class="n">R</span> <span class="n">E</span> <span class="mh">0x1000</span>
  <span class="n">LOAD</span>           <span class="mh">0x000304</span> <span class="mh">0x0819b304</span> <span class="mh">0x0819b304</span> <span class="mh">0x00000</span> <span class="mh">0x00000</span> <span class="n">RW</span>  <span class="mh">0x1000</span>
</code></pre></div></div>

<p>The binary’s string table has been stripped, aswell as the section header table.
In addition, the binary only contains two segments. Based on the number of segments, and the strange base address it holds (0x00c01000) we can assume that the file is packed.
Furthermore, note that the file and size memory for the second <code class="highlighter-rouge">PT_LOAD</code> segment are set to 0. meaning that when segment will get loaded to memory, there will be a 0x1000 chunk at <code class="highlighter-rouge">0x0819b304</code> due to segment alignment.</p>

<p>Is common in Linux systems to encounter packed malware with UPX. I then tried to see if I could find the <code class="highlighter-rouge">UPX</code> magic in the file.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x00c8da20</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">/</span> <span class="n">UPX</span>
<span class="n">Searching</span> <span class="mi">3</span> <span class="n">bytes</span> <span class="n">from</span> <span class="mh">0x00000000</span> <span class="n">to</span> <span class="mh">0xffffffffffffffff</span><span class="o">:</span> <span class="mi">55</span> <span class="mi">50</span> <span class="mi">58</span> 
<span class="n">Searching</span> <span class="mi">3</span> <span class="n">bytes</span> <span class="n">in</span> <span class="p">[</span><span class="mh">0xc01000</span><span class="o">-</span><span class="mh">0xc8e1c2</span><span class="p">]</span>
<span class="n">hits</span><span class="o">:</span> <span class="mi">1</span>
<span class="mh">0x00c8ddaa</span> <span class="n">hit0_0</span> <span class="p">.</span><span class="err">@</span><span class="n">M</span><span class="p">{</span><span class="n">UPX</span><span class="o">!</span><span class="n">u</span><span class="o">&gt;</span><span class="n">RBuvkk</span><span class="p">.</span>
<span class="p">[</span><span class="mh">0x00c8da20</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">s</span> <span class="n">hit0_0</span> <span class="o">-</span><span class="mi">2</span>
<span class="p">[</span><span class="mh">0x00c8dda8</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pd</span> <span class="mi">1</span>
            <span class="mh">0x00c8dda8</span>  <span class="o">~</span>   <span class="mi">81</span><span class="n">f955505821</span>   <span class="n">CMP</span> <span class="n">ECX</span><span class="p">,</span> <span class="mh">0x21585055</span>
<span class="p">[</span><span class="mh">0x00c8dda8</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">?</span> <span class="mh">0x21585055</span><span class="o">~</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="s">"UPX!"</span> 
<span class="p">[</span><span class="mh">0x00c8dda8</span><span class="p">]</span><span class="o">&gt;</span> 
</code></pre></div></div>
<p>This is quite interesting because if we try to use the automated unpacking feature of <code class="highlighter-rouge">UPX</code> we get an error:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">upx</span> <span class="o">-</span><span class="n">d</span> <span class="n">f22ffc07e0cc907f00fd6a4ecee09fe8411225badb2289c1bffa867a2a3bd863</span>
                       <span class="n">Ultimate</span> <span class="n">Packer</span> <span class="k">for</span> <span class="n">eXecutables</span>
                          <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">1996</span> <span class="o">-</span> <span class="mi">2017</span>
<span class="n">UPX</span> <span class="mi">3</span><span class="p">.</span><span class="mi">94</span>        <span class="n">Markus</span> <span class="n">Oberhumer</span><span class="p">,</span> <span class="n">Laszlo</span> <span class="n">Molnar</span> <span class="o">&amp;</span> <span class="n">John</span> <span class="n">Reiser</span>   <span class="n">May</span> <span class="mi">12</span><span class="n">th</span> <span class="mi">2017</span>

        <span class="n">File</span> <span class="n">size</span>         <span class="n">Ratio</span>      <span class="n">Format</span>      <span class="n">Name</span>
   <span class="o">--------------------</span>   <span class="o">------</span>   <span class="o">-----------</span>   <span class="o">-----------</span>
<span class="n">upx</span><span class="o">:</span> <span class="n">f22ffc07e0cc907f00fd6a4ecee09fe8411225badb2289c1bffa867a2a3bd863</span><span class="o">:</span> 
<span class="n">NotPackedException</span><span class="o">:</span> <span class="n">not</span> <span class="n">packed</span> <span class="n">by</span> <span class="n">UPX</span>

<span class="n">Unpacked</span> <span class="mi">0</span> <span class="n">files</span><span class="p">.</span>
</code></pre></div></div>

<p>Threfore, we may be dealing with a custom packer based on a modified version of <code class="highlighter-rouge">UPX</code>.
We will statically analyse the sample first, then we will continue our analysis with some dynamic analysis. At the end a brief summary of the sample will be discussed. Let’s start with static analysis.</p>

<p><br />
<br /></p>
<h2> Static Analysis</h2>
<p><br /></p>

<p>If we open the binary with <code class="highlighter-rouge">IDA PRO</code> we can confirm that the sample is indeed packed:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/2.png" /></div>
<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/3.png" /></div>
<p><br /></p>

<p>There are only 3 identifiable functions. Second and third functions seem straight forward. One allocates a <code class="highlighter-rouge">RWX</code> page sized chunk, and the latter executes a write syscall and then exits.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/5.png" /></div>
<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/4.png" /></div>
<p><br /></p>

<p>The entry point of the application looks certainly more messier, and by first glance we can assume that it will have a decryptor/decoder functionality.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/6.png" /></div>
<p><br /></p>

<p>The first thing that the entrypoint does is calling <code class="highlighter-rouge">0x00C8DC28</code>, which itself redirects execution to <code class="highlighter-rouge">allocate_rwx_page</code> and stores the return address (<code class="highlighter-rouge">start+5</code>) in ebp.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/7.png" /></div>
<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/8.png" /></div>
<p><br /></p>

<p>Note the stub of data on <code class="highlighter-rouge">0x00C8DC31</code>, we will come back to it later.
Execution then falls into <code class="highlighter-rouge">allocate_rwx_page</code> function, which as said before just allocates a memory page with <code class="highlighter-rouge">RXW</code> permissions. This buffer will be allocated at <code class="highlighter-rouge">0x00C8F000</code>. If the allocation fails, then execution will branch into the <code class="highlighter-rouge">write_message_and_exit</code> funtion, in which the string <code class="highlighter-rouge">'nandemo wa shiranai wa yo,'</code> gets printed to <code class="highlighter-rouge">stderr</code>. On the other hand, if allocation of RWX chunk is sucessfull, execution will pivot back to <code class="highlighter-rouge">start+5</code>.</p>

<p>After allocating RWX memory, the malware will then proceed to copy and decode a given stub inside it. After a while analysing the code, I got to the conclusion that function <code class="highlighter-rouge">start+5</code> (entrypoint+5) is the routine the malware uses to decode and copy packer stub. At this point I coudn’t do much progress just by static analysis. Therefore, I fired up the debugger ready to do some dynamic analysis.</p>

<p><br />
<br /></p>
<h2> Dynamic Analysis </h2>
<p><br /></p>

<p>Now that we have identified what routine the malware uses to decode and copy packer stub, It will be straight forward to trace the malware’s first stage, that is to decode some stub inside the RWX chunk by decoding the data block previosly shown. We will try to follow along execution flow until the destination chunk (chunk <code class="highlighter-rouge">0x00c8f000</code>) of the decoded stub to remain with our analysis. One way this could be achieved would be by setting a hardware breakpoint on execution at the <code class="highlighter-rouge">RXW</code> chunk. However, we want to find the cleanest possible way to withness the execution transition into the chunk in order to not overlook details about the first malware’s pivoting endeavour.</p>

<p>On the entrypoint routine, after the function <code class="highlighter-rouge">pivot_to_allocate_rwx_pg</code> we can clearly see that the register context is being saved with a <code class="highlighter-rouge">pusha</code> instruction. Furthermore, two pointers are loaded into the <code class="highlighter-rouge">esi</code> and <code class="highlighter-rouge">edi</code> registers. Those pointers are the stub source address to be decoded, and the destination buffer address to transfer the decoded stub.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/10.png" /></div>
<p><br /></p>

<p>Further down <code class="highlighter-rouge">start</code> we can see the set of instructions in charge of copying data from stub to the destination buffer:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/15.png" /></div>
<p><br /></p>

<p>Nevertheless, There are specific bytes that get processed differently. Some of the stub bytes have a many to one relationship with decoded bytes, so that multiple decoded bytes get derived from a single stub byte. Based on this we can assume that the decoding algorithm must be some sort of deflate implementation.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/16.png" /></div>
<p><br /></p>

<p>We can see that decoding will stop when second argument <code class="highlighter-rouge">stub_size</code> + first argument <code class="highlighter-rouge">stub_base</code> == current stub pointer at <code class="highlighter-rouge">esi</code>. If this condition is true, the function simply returns.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/11.png" /></div>
<p><br /></p>

<p>If we put a breakpoint on this <code class="highlighter-rouge">retn</code> instruction and then resume the application we will get control of execution back when decoding is over.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/12.png" /></div>
<p><br /></p>

<p>Upon decoding finalization, decoding routine does not pivot directly to the RWX chunk at <code class="highlighter-rouge">0x00c8f000</code>, but it returns first to <code class="highlighter-rouge">allocate_rwx_page+49</code> to then unwind the stack and return to the RWX chunk.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/13.png" /></div>
<p><br /></p>

<p>When execution reaches the <code class="highlighter-rouge">0x00C8F000</code> chunk, we see the following routine:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/14.png" /></div>
<p><br /></p>

<p>The main purpose of this routine is to retrieve the <code class="highlighter-rouge">ELF Auxiliar vector</code> from the stack and copy it into a local stack buffer. The retrieved struture of the Auxiliar vector looks as follows:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/17.png" /></div>
<p><br /></p>

<p>Once Auxiliar vector is retrived from stack then <code class="highlighter-rouge">call_read_link</code> function gets called. This function looks as follows:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/18.png" /></div>
<p><br /></p>

<p>In this function a series of statistics are retrieved from the current file such as the location of the embedded <code class="highlighter-rouge">Elf</code> file in the first <code class="highlighter-rouge">PT_LOAD</code> segment along with 2 more flags used for decoding. Furthermore, the address of the page-aligned end of the first <code class="highlighter-rouge">PT_LOAD</code> segment is computed and a stack buffer is reserved in order to store decoded stub. After collecting these fields this function proceeds with <code class="highlighter-rouge">stage1</code> of the decoding process and calls <code class="highlighter-rouge">init_decoding_stage</code> function. This function looks as follows:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/19.jpg" /></div>
<p><br /></p>

<p>This routine is the entry point of what would be the stub decoding stage. the first part of this function calls <code class="highlighter-rouge">set_for_decoding</code> function . This function gets called with the previously reserved stack buffer dedicated for storing decoded stub and two stub flags as arguments. Function <code class="highlighter-rouge">set_for_decoding</code> looks as follows:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/20.jpg" /></div>
<p><br /></p>

<p>Based on the flags passed to this function it will copy different values of the stub into a prepared buffer. We see that when stub buffer is ready the decoding function will get called (<code class="highlighter-rouge">start+5</code>).
If we step into the decoding function we see that the values in <code class="highlighter-rouge">esi</code> and <code class="highlighter-rouge">edi</code> registers have changed in comparison with the earlier call to this function:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/21.png" /></div>
<p><br /></p>

<p>If we continue until our previously saved breakpoint at <code class="highlighter-rouge">retn</code> instruction we can identify an ELF header and a program header table within the destination buffer after decoding.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/22.png" /></div>
<p><br /></p>

<p>Once the ELF header and the Program header table of embedded file get decded, execution continues after the call to <code class="highlighter-rouge">set_for_decoding</code> in the <code class="highlighter-rouge">init_decoding_stage</code> function.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/23.png" /></div>
<p><br /></p>

<p>Now that the program header table of embedded executable is decoded the malware is able to parse some of its fields in order to figure out where to load in memory its correspondent segments for sucesfull unpacking. Furthermore, the malware updates it’s own <code class="highlighter-rouge">Auxiliar vector</code> with statistics of the embedded file in order to reuse that same structure on the loading process of the embedded executable. Malware updates <code class="highlighter-rouge">AT_PHNUM</code> , <code class="highlighter-rouge">AT_PHENT</code> and <code class="highlighter-rouge">AT_PHDR</code> fields of the <code class="highlighter-rouge">Auxiliar vector</code> at this point but it will be updating more fields in the remaining decoding process. After updating the Auxiliar vector, malware calls <code class="highlighter-rouge">ux_exec</code> function. This function is sort of an <code class="highlighter-rouge">execve</code> userland implementation which is in charge of loading the embedded executable segments and pivot execution to the <code class="highlighter-rouge">OEP</code> without interaction with the kernel. This function looks as follows:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/24.jpg" /></div>
<p><br /></p>

<p><code class="highlighter-rouge">Ux_exec</code> function first scans all segments in decoded proram header table in order to find the <code class="highlighter-rouge">CODE</code> segment( the first <code class="highlighter-rouge">PT_LOAD</code> segment). Once <code class="highlighter-rouge">CODE</code> segment has been found, a mmap system call gets invoked via <code class="highlighter-rouge">mmap_gate</code> function, passing the segment’s <code class="highlighter-rouge">p_vaddr</code> value along with its page aligned <code class="highlighter-rouge">p_memsz</code> field as arguments. Upon<code class="highlighter-rouge">CODE</code> segment allocation execution flow enters a loop in which every <code class="highlighter-rouge">PT_LOAD</code> segments existent in the program header table gets scanned to be decoded. For every <code class="highlighter-rouge">PT_LOAD</code> segment that is not the <code class="highlighter-rouge">CODE</code> segment, this loop will call <code class="highlighter-rouge">mmap_gate</code> function again in order to map the segment.</p>

<p>For every existent <code class="highlighter-rouge">PT_LOAD</code> segment, a call to <code class="highlighter-rouge">set_for_decoding</code> is made. We already cover this function previously. Therefore, I will try to avoid redundancy and I will not explain this routine again. After the <code class="highlighter-rouge">set_fo_decoding</code> call, our breakpoint in the decoding routine gets triggered once again and this time seems to be decoding into the base address of the embedded binary:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/25.png" /></div>
<p><br /></p>

<p>Once our <code class="highlighter-rouge">retn</code> breakpoint gets triggered, the destination buffer seems partially decoded:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/26.png" /></div>
<p><br /></p>

<p>The segments get decoded in rounds, the following screenshot is the second round of the <code class="highlighter-rouge">CODE</code> segment’s decoding, so we can have an idea how the decoding looks like:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/27.png" /></div>
<p><br /></p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/28.png" /></div>
<p><br /></p>

<p>Upon segment decoding completion, a <code class="highlighter-rouge">mprotect</code> system call is invoked in order to enforce the original segment’s attributes. This is due to the fact that when container chunk was allocated by <code class="highlighter-rouge">mmap</code> syscall it must had wrtie permissions in order to write the decoded stub into the chunk.
The code also checks if current segment base + size exceeds the end of the <code class="highlighter-rouge">DATA</code> segment. If that is the case, a chunk will be mmapped after the <code class="highlighter-rouge">DATA</code> segment, and a <code class="highlighter-rouge">brk</code> syscall will be invoked. The <code class="highlighter-rouge">brk</code> system call will initialise a series of pointers that would make the mmap chunk at the end of the data segment being initialised as the <code class="highlighter-rouge">HEAP</code> segment. <code class="highlighter-rouge">brk</code> systemcall does not actually allocate any memory, just initialises <code class="highlighter-rouge">program break</code>, <code class="highlighter-rouge">start_brk</code> and <code class="highlighter-rouge">end_data</code>. However, at this very point there is no <code class="highlighter-rouge">HEAP</code> segment since initially program break = start_brk. Nevertheless, in future malloc calls the program break address will increase and the <code class="highlighter-rouge">HEAP</code> segment (space between start_brk and program break) will fall within the mmapped chunk at the end of the <code class="highlighter-rouge">DATA</code> segment.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/29.png" /></div>
<p><br /></p>

<p>After <code class="highlighter-rouge">ux_exec</code> function is done loading all segments of embedded executable, control flow returns back to <code class="highlighter-rouge">init_decoding_stage</code> after the call to <code class="highlighter-rouge">ux_exec</code>. There is just one more thing remaining to do before pivoting to OEP, check for a <code class="highlighter-rouge">PT_INTERP</code> segment. If this segment exists then the embedded executable is a dynamically linked executable, and the <code class="highlighter-rouge">RTLD</code> must be mapped. The <code class="highlighter-rouge">RTLD</code> will be opened, read and then a call to <code class="highlighter-rouge">ux_exec</code> will be done again in order to map the shared object’s segments into the right location within the virtual address space.</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/30.png" /></div>
<p><br /></p>

<p>So far we covered all steps the packer does for decoding and loading the embedded executable. A brief overview of the packer’s functionality is the following:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/prev.png" /></div>
<p><br /></p>

<p>At this point we know that the file is fully loaded into its respective virtual address. If we check the mappings we see the following:</p>

<p><br /></p>
<div style="text-align:center"><img src="https://github.com/n4x0r/n4x0r.github.io/raw/master/images/Tsunami/31.png" /></div>
<p><br /></p>

<p>In order to retrieve the embedded executable we can use the following IDA script to dump the embedded file succesfully:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">struct</span>

<span class="k">class</span> <span class="nc">Elf32Phdr</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_type</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_offset</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_vaddr</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_paddr</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_filesz</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_memsz</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_flags</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_align</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">"8I"</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">[:</span><span class="mh">0x20</span><span class="p">])</span>

<span class="k">class</span> <span class="nc">ElfEhdr</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_type</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_machine</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_version</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_entry</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phoff</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shoff</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_flags</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_ehsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phentsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phnum</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shentsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shnum</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shstrndx</span><span class="p">)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">"2H5I6H"</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">52</span><span class="p">])</span>
     
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"2H5I6H"</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_type</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_machine</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_version</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_entry</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phoff</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shoff</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_flags</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_ehsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phentsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_phnum</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shentsize</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shnum</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">e_shstrndx</span><span class="p">)</span> 

<span class="k">def</span> <span class="nf">dumpElf</span><span class="p">(</span><span class="n">image_base</span><span class="p">):</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"/Users/n4x0r/Desktop/dumped.elf"</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="n">GetManyBytes</span><span class="p">(</span><span class="n">image_base</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span>
    
    <span class="n">ehdr</span>  <span class="o">=</span> <span class="n">ElfEhdr</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span> 
    <span class="n">phoff</span> <span class="o">=</span> <span class="n">ehdr</span><span class="o">.</span><span class="n">e_phoff</span>
    <span class="n">phnum</span> <span class="o">=</span> <span class="n">ehdr</span><span class="o">.</span><span class="n">e_phnum</span>
    <span class="n">phdrtbl</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">[</span><span class="n">phoff</span><span class="p">:]</span>

    <span class="n">ehdr</span><span class="o">.</span><span class="n">e_shoff</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ehdr</span><span class="o">.</span><span class="n">e_shnum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ehdr</span><span class="o">.</span><span class="n">e_shstrndx</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">phnum</span><span class="p">):</span>
        <span class="n">phdr</span> <span class="o">=</span> <span class="n">Elf32Phdr</span><span class="p">(</span><span class="n">phdrtbl</span><span class="p">[:</span><span class="mh">0x20</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">phdr</span><span class="o">.</span><span class="n">p_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">poffs</span> <span class="o">=</span> <span class="n">phdr</span><span class="o">.</span><span class="n">p_offset</span>
            <span class="n">psize</span> <span class="o">=</span> <span class="n">phdr</span><span class="o">.</span><span class="n">p_filesz</span>
            <span class="n">paddr</span> <span class="o">=</span> <span class="n">phdr</span><span class="o">.</span><span class="n">p_vaddr</span>
            <span class="n">phdata</span> <span class="o">=</span> <span class="n">GetManyBytes</span><span class="p">(</span><span class="n">paddr</span><span class="p">,</span> <span class="n">psize</span><span class="p">)</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">poffs</span><span class="p">)</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">phdata</span><span class="p">)</span>
        <span class="n">phdrtbl</span> <span class="o">=</span> <span class="n">phdrtbl</span><span class="p">[</span><span class="mh">0x20</span><span class="p">:]</span>
    <span class="nb">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ehdr</span><span class="p">))</span>   
    <span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="s">"[+] Elf Dumped"</span>
</code></pre></div></div>

<p>Once on disk we see that the dumped file is a 1.3M statically linked binary:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ELF</span> <span class="n">Header</span><span class="o">:</span>
  <span class="n">Magic</span><span class="o">:</span>   <span class="mi">7</span><span class="n">f</span> <span class="mi">45</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">46</span> <span class="mo">01</span> <span class="mo">01</span> <span class="mo">01</span> <span class="mo">03</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> 
  <span class="n">Class</span><span class="o">:</span>                             <span class="n">ELF32</span>
  <span class="n">Data</span><span class="o">:</span>                              <span class="mi">2</span><span class="err">'</span><span class="n">s</span> <span class="n">complement</span><span class="p">,</span> <span class="n">little</span> <span class="n">endian</span>
  <span class="n">Version</span><span class="o">:</span>                           <span class="mi">1</span> <span class="p">(</span><span class="n">current</span><span class="p">)</span>
  <span class="n">OS</span><span class="o">/</span><span class="n">ABI</span><span class="o">:</span>                            <span class="n">UNIX</span> <span class="o">-</span> <span class="n">GNU</span>
  <span class="n">ABI</span> <span class="n">Version</span><span class="o">:</span>                       <span class="mi">0</span>
  <span class="n">Type</span><span class="o">:</span>                              <span class="n">EXEC</span> <span class="p">(</span><span class="n">Executable</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Machine</span><span class="o">:</span>                           <span class="n">Intel</span> <span class="mi">80386</span>
  <span class="n">Version</span><span class="o">:</span>                           <span class="mh">0x1</span>
  <span class="n">Entry</span> <span class="n">point</span> <span class="n">address</span><span class="o">:</span>               <span class="mh">0x8048d86</span>
  <span class="n">Start</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>          <span class="mi">52</span> <span class="p">(</span><span class="n">bytes</span> <span class="n">into</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Start</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>          <span class="mi">0</span> <span class="p">(</span><span class="n">bytes</span> <span class="n">into</span> <span class="n">file</span><span class="p">)</span>
  <span class="n">Flags</span><span class="o">:</span>                             <span class="mh">0x0</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">this</span> <span class="n">header</span><span class="o">:</span>               <span class="mi">52</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>           <span class="mi">32</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Number</span> <span class="n">of</span> <span class="n">program</span> <span class="n">headers</span><span class="o">:</span>         <span class="mi">6</span>
  <span class="n">Size</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>           <span class="mi">40</span> <span class="p">(</span><span class="n">bytes</span><span class="p">)</span>
  <span class="n">Number</span> <span class="n">of</span> <span class="n">section</span> <span class="n">headers</span><span class="o">:</span>         <span class="mi">0</span>
  <span class="n">Section</span> <span class="n">header</span> <span class="n">string</span> <span class="n">table</span> <span class="n">index</span><span class="o">:</span> <span class="mi">0</span>

<span class="n">Program</span> <span class="n">Headers</span><span class="o">:</span>
  <span class="n">Type</span>           <span class="n">Offset</span>   <span class="n">VirtAddr</span>   <span class="n">PhysAddr</span>   <span class="n">FileSiz</span> <span class="n">MemSiz</span>  <span class="n">Flg</span> <span class="n">Align</span>
  <span class="n">LOAD</span>           <span class="mh">0x000000</span> <span class="mh">0x08048000</span> <span class="mh">0x08048000</span> <span class="mh">0x14ba2e</span> <span class="mh">0x14ba2e</span> <span class="n">R</span> <span class="n">E</span> <span class="mh">0x1000</span>
  <span class="n">LOAD</span>           <span class="mh">0x14bea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x02374</span> <span class="mh">0x06460</span> <span class="n">RW</span>  <span class="mh">0x1000</span>
  <span class="n">NOTE</span>           <span class="mh">0x0000f4</span> <span class="mh">0x080480f4</span> <span class="mh">0x080480f4</span> <span class="mh">0x00044</span> <span class="mh">0x00044</span> <span class="n">R</span>   <span class="mh">0x4</span>
  <span class="n">TLS</span>            <span class="mh">0x14bea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x00014</span> <span class="mh">0x00038</span> <span class="n">R</span>   <span class="mh">0x4</span>
  <span class="n">GNU_STACK</span>      <span class="mh">0x000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000000</span> <span class="mh">0x00000</span> <span class="mh">0x00000</span> <span class="n">RW</span>  <span class="mh">0x10</span>
  <span class="n">GNU_RELRO</span>      <span class="mh">0x14bea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x08194ea4</span> <span class="mh">0x0115c</span> <span class="mh">0x0115c</span> <span class="n">R</span>   <span class="mh">0x1</span>
</code></pre></div></div>

<p><br />
<br /></p>
<h2>Summary</h2>
<p>This packer was straight forward to unpack since it did not implement any anti-debugging/anti-dump/anti-analysis techniques. 
Therefore, the unpacking process could have been much quicker:</p>

<ul>
  <li>Tracing until decoding of Elf header and program header table.</li>
  <li>Set hardware breapoint on execution at entry-point address in the Elf header.</li>
  <li>Profit.</li>
</ul>

<script type="text/javascript" src="https://asciinema.org/a/OfiADjXfl73JB9mfe8vBqnidR.js" id="asciicast-OfiADjXfl73JB9mfe8vBqnidR" async=""></script>

<p>In the next write up I will cover the analysis process of the unpacked file. 
Thanks for reading and I hope you learned something useful from this post!.</p>

<p>n4x0r.</p>


            </div>

        </article>
    </div>

    <div class="col-sm-4">
        <div class="panel panel-default">
    <div class="panel-heading">
        <strong>Malware Posts</strong>
    </div>

    <div class="panel-body">
        
        
        
        <div>
            <h4 class="archive-title">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <a href="#">2020</a>
            </h4>
            <ul class="list-group archive-list" style="display: none;">
                
                
                
                <li class="list-group-item">
                    <a href="/blog/article/2020/03/03/Deobfuscation_1.html">Tales Of Binary Deobfuscation...</a>
                        <span class="badge">
                            <time>03 Mar</time>
                        </span>
                </li>
                
                
                
                
            </ul>
        </div>
        <div>
            <h4 class="archive-title">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <a href="#">2019</a>
            </h4>
            <ul class="list-group archive-list" style="display: none;">
                
                <li class="list-group-item">
                    <a href="/blog/article/2019/05/29/HiddenWasp.html">HiddenWasp: Another piece of ...</a>
                        <span class="badge">
                            <time>29 May</time>
                        </span>
                </li>
                
                
                
                
            </ul>
        </div>
        <div>
            <h4 class="archive-title">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <a href="#">2017</a>
            </h4>
            <ul class="list-group archive-list" style="display: none;">
                
                <li class="list-group-item">
                    <a href="/blog/article/2017/11/17/UnPacking_a_Linux_Tsunami_Sample.html">Manually Unpacking Modified U...</a>
                        <span class="badge">
                            <time>17 Nov</time>
                        </span>
                </li>
                
            </ul>
        </div>
        
    </div>
</div>

    </div>
</div>


				<hr />

				<footer class="container-fluid amnesia_site-footer">
    <div class="row">
        <div class="col-xs-6">
            <blockquote>
                <p>
                    ulexec's blog
                </p>
                <p>
                    <small>Bona Fides</small>
                </p>
            </blockquote>
        </div>
    </div>
</footer>

			</div>
	</div>
	</body>

		<script src="/blog/js/app.js"></script>
		<script src="/blog/js/jquery.min.js"></script>
		<script src="/blog/js/bootstrap.min.js"></script>
		<script src="/blog/js/scripts.js"></script>


</html>
